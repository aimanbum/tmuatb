<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LAMAN TMUATB</title>
    <link rel="icon" type="image/png" href="logo.png">
    <style>
        body { font-family: 'Segoe UI', Arial, sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; color: #2c3e50; }
        .container { max-width: 900px; margin: auto; background: #ffffff; padding: 30px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.05); border-top: 6px solid #003366; text-align: center; }
        .logo-sekolah { width: 90px; height: auto; margin-bottom: 10px; }
        h1 { font-size: 20px; color: #003366; text-transform: uppercase; margin: 5px 0; }
        .sub-header { font-size: 14px; color: #7f8c8d; margin-bottom: 30px; }

        .link-section { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 40px; }
        .btn { display: flex; align-items: center; justify-content: center; padding: 20px 10px; background: #ffffff; color: #003366; text-decoration: none; border: 1px solid #dee2e6; border-radius: 8px; font-weight: bold; font-size: 12px; transition: 0.3s; text-transform: uppercase; }
        .btn:hover { background: #003366; color: #ffffff; }

        /* KOTAK ENROLMEN */
        .enrolmen-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-top: 10px; }
        .stat-card { background: #f1f4f8; padding: 15px 5px; border-radius: 8px; border: 1px solid #d1d8e0; transition: 0.3s; }
        .stat-card h4 { margin: 0; font-size: 12px; color: #003366; }
        .stat-number { font-size: 24px; font-weight: bold; color: #333; margin: 5px 0; }
        .stat-detail { font-size: 11px; color: #666; font-weight: 500; }
        .loading { font-style: italic; color: #999; font-size: 12px; }

        @media (max-width: 768px) {
            .link-section { grid-template-columns: 1fr; }
            .enrolmen-grid { grid-template-columns: repeat(2, 1fr); }
        }
        .footer { margin-top: 40px; font-size: 10px; color: #bdc3c7; border-top: 1px solid #eee; padding-top: 15px; }
    </style>
</head>
<body>
    <div class="container">
        <img src="logo.png" alt="Logo SMKATB" class="logo-sekolah">
        <h1>LAMAN TMUA TOK BACHOK</h1>
                
        <div class="link-section">
            <a href="https://drive.google.com/drive/folders/1Z07QYsqg-YRuqNiR4YXg7hQLwHGhCt8p?usp=sharing" class="btn" target="_blank">HALAQAH 2026</a>
            <a href="https://drive.google.com/drive/folders/1R4FdjBu_MviJWC51DVcEiyQpBSGGm-PG?usp=sharing" class="btn" target="_blank">REKOD HAFAZAN</a>
            <a href="https://aimanbum.github.io/dashboardhafazan/" class="btn" target="_blank">DASHBOARD</a>
            <a href="https://docs.google.com/spreadsheets/d/1xx5BP8lhLu6eqke5RfqEZUs3BnPgLS9u/edit?gid=1105382656#gid=1105382656" class="btn" target="_blank">RPT HIFZ 2026</a>
            <a href="https://forms.gle/MZYJB4YxUYbUkG238" class="btn" target="_blank">REKOD KHATAM</a>
            <a href="https://mylink.la/sekolah-3315" class="btn" target="_blank">ONE STOP CENTRE</a>
        </div>

        <h3 style="font-size: 16px; color: #003366; margin-bottom: 15px;">JUMLAH ENROLMEN PELAJAR (LIVE)</h3>
        
        <div class="enrolmen-grid" id="enrolmen-container">
            <div class="stat-card">
                <h4>TINGKATAN 1</h4>
                <div class="stat-number" id="t1-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t1-detail">L: - | P: -</div>
            </div>
            <div class="stat-card">
                <h4>TINGKATAN 2</h4>
                <div class="stat-number" id="t2-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t2-detail">L: - | P: -</div>
            </div>
            <div class="stat-card">
                <h4>TINGKATAN 3</h4>
                <div class="stat-number" id="t3-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t3-detail">L: - | P: -</div>
            </div>
            <div class="stat-card">
                <h4>TINGKATAN 4</h4>
                <div class="stat-number" id="t4-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t4-detail">L: - | P: -</div>
            </div>
            <div class="stat-card">
                <h4>TINGKATAN 5</h4>
                <div class="stat-number" id="t5-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t5-detail">L: - | P: -</div>
            </div>
            <div class="stat-card">
                <h4>TINGKATAN 6</h4>
                <div class="stat-number" id="t6-total"><span class="loading">...</span></div>
                <div class="stat-detail" id="t6-detail">L: - | P: -</div>
            </div>
        </div>

        <div class="footer">
            Data dikemaskini secara langsung dari Google Sheets<br>
            SMKA TOK BACHOK &copy; 2026
        </div>
    </div>

    <script>
        // Masukkan ID Spreadsheet anda di sini
        const ssID = '1M5HM5y6qgWshsLqB8CoReXiF54sFiUBiS_dVqUtK0gk';
        const url = `https://docs.google.com/spreadsheets/d/${ssID}/gviz/tq?tqx=out:csv`;

        async function fetchEnrolmen() {
            try {
                const response = await fetch(url);
                const data = await response.text();
                const rows = data.split('\n').map(row => row.split(',').map(cell => cell.replace(/"/g, '')));

                // Fungsi untuk ambil data sel (Format CSV: Baris bermula dari 0, Kolum A=0, B=1, C=2, D=3)
                // C7 = Row 6, Col 2 | D7 = Row 6, Col 3
                const getData = (r, c) => parseInt(rows[r][c]) || 0;

                const updateCard = (id, rowL, rowP) => {
                    const l = getData(rowL - 1, 2); // Kolum C
                    const p = getData(rowP - 1, 3); // Kolum D
                    document.getElementById(`${id}-total`).innerText = l + p;
                    document.getElementById(`${id}-detail`).innerText = `L: ${l} | P: ${p}`;
                };

                // Kemaskini setiap tingkatan ikut koordinat yang anda beri
                updateCard('t1', 7, 7);
                updateCard('t2', 13, 13);
                updateCard('t3', 19, 19);
                updateCard('t4', 25, 25);
                updateCard('t5', 31, 31);
                updateCard('t6', 36, 36);

            } catch (error) {
                console.error('Gagal mengambil data:', error);
            }
        }

        fetchEnrolmen();
    </script>
</body>
</html>
